@page "/GenerarCertificado"
@inject HttpClient Http
@inject IJSRuntime JS

<h3>Generar Certificado</h3>

<form>
    <label>Nombre:</label>
    <input type="text" @bind="nombre" />

    <label>Apellido:</label>
    <input type="text" @bind="apellido" />

    <label>Documento:</label>
    <input type="text" @bind="documento" />

    <button type="button" @onclick="OnGenerateCertificado">Generar PDF</button>
</form>

@code {
    private string nombre;
    private string apellido;
    private string documento;

    private async Task OnGenerateCertificado()
    {
        var url = $"https://localhost:7118/api/CertificadoAlumnos/test?nombre={nombre}&apellido={apellido}&documento={documento}";

        var response = await Http.GetAsync(url);

        if (response.IsSuccessStatusCode)
        {
            var pdfData = await response.Content.ReadAsByteArrayAsync();
            var base64Data = Convert.ToBase64String(pdfData);

            // Llamada a JavaScript para descargar el archivo PDF
            await JS.InvokeVoidAsync("downloadFileFromBase64", base64Data, "Certificado.pdf");
        }
        else
        {
            Console.WriteLine("Error al generar el PDF.");
        }
    }
}

